classDiagram
direction TB
class node25 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   codes_hs_id  /* FK на codes_hs (код ТН ВЭД) */ integer
   codes_units_id  /* FK на codes_units (единица измерения) */ integer
   integer id  /* Первичный ключ */
}
class node30 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   varchar okpo  /* ОКПО банка */
   varchar inn  /* ИНН банка */
   mfo  /* МФО банка (обязательно для графы 28) */ varchar
   varchar name  /* Наименование банка */
   varchar address  /* Адрес банка */
   integer id  /* Первичный ключ */
}
class node6 {
   period_start  /* Начало периода (день) */ date
   text period_type  /* Тип периода: daily */
   text actor_scope  /* Скоуп актора: user | org_user | organization */
   organization_id  /* Идентификатор организации (если применимо) */ integer
   user_id  /* Идентификатор пользователя (если применимо) */ integer
   text status_group  /* Группа статусов: completed | pending | failed */
   bigint ccd_count  /* Количество CCD за период/скоуп/статус */
}
class node3 {
   period_start  /* Начало периода (месяц) */ date
   text period_type  /* Тип периода: monthly */
   text actor_scope  /* Скоуп актора: user | org_user | organization */
   organization_id  /* Идентификатор организации (если применимо) */ integer
   user_id  /* Идентификатор пользователя (если применимо) */ integer
   text status_group  /* Группа статусов: completed | pending | failed */
   bigint ccd_count  /* Количество CCD за период/скоуп/статус */
}
class node37 {
   period_start  /* Начало периода (неделя) */ date
   text period_type  /* Тип периода: weekly */
   text actor_scope  /* Скоуп актора: user | org_user | organization */
   organization_id  /* Идентификатор организации (если применимо) */ integer
   user_id  /* Идентификатор пользователя (если применимо) */ integer
   text status_group  /* Группа статусов: completed | pending | failed */
   bigint ccd_count  /* Количество CCD за период/скоуп/статус */
}
class node42 {
   period_start  /* Начало периода (год) */ date
   text period_type  /* Тип периода: yearly */
   text actor_scope  /* Скоуп актора: user | org_user | organization */
   organization_id  /* Идентификатор организации (если применимо) */ integer
   user_id  /* Идентификатор пользователя (если применимо) */ integer
   text status_group  /* Группа статусов: completed | pending | failed */
   bigint ccd_count  /* Количество CCD за период/скоуп/статус */
}
class node19 {
   created_at  /* Служебное поле: дата/время создания записи (не графа) */ timestamp with time zone
   updated_at  /* Служебное поле: дата/время изменения (не графа) */ timestamp with time zone
   deleted_at  /* Служебное поле: дата/время удаления (soft delete; не графа) */ timestamp with time zone
   status  /* Служебное поле статуса CCD (completed/pending/failed и т.п.; ... */ text
   created_by_user_id  /* Автор CCD (пользователь платформы) для аналитики и аудита */ integer
   organization_id  /* Организация-владелец CCD (для аналитики по организациям) */ integer
   form_id  /* FK на codes_forms (Графа 1: форма/тип декларации) */ integer
   direction_code  /* Графа 1: код направления (ИМ/ЭК/ТР/НД) */ varchar(3)
   regime_code  /* Графа 1: код режима (двухзначный), хранится строкой до ввода ... */ varchar(8)
   third_subdivision  /* Графа 1: третий подраздел (например, ПНД) */ varchar(3)
   total_sheets  /* Графа 3: всего листов (авто) */ integer
   items_count  /* Графа 5: всего позиций (авто) */ integer
   post_id  /* FK на codes_posts (Графа 7: таможенный пост оформления) */ integer
   exporter_legal_id  /* FK на fea_legal_entities (Графа 2: экспортер/отправитель юр.л... */ integer
   exporter_individual_id  /* FK на fea_individual_entities (Графа 2: экспортер/отправитель... */ integer
   consignee_legal_id  /* FK на fea_legal_entities (Графа 8: получатель юр.лицо); может... */ integer
   consignee_individual_id  /* FK на fea_individual_entities (Графа 8: получатель физ.лицо) */ integer
   declarant_legal_id  /* FK на fea_legal_entities (Графа 14: декларант/брокер юр.лицо)... */ integer
   declarant_individual_id  /* FK на fea_individual_entities (Графа 14: декларант/брокер физ... */ integer
   financial_legal_id  /* FK на fea_legal_entities (Графа 9: лицо, ответственное за фин... */ integer
   financial_individual_id  /* FK на fea_individual_entities (Графа 9: лицо, ответственное з... */ integer
   integer exporter_legal_short_id  /* FK на fea_legal_entities_short: быстрый выбор экспортера/отпр... */
   consignee_legal_short_id  /* FK на fea_legal_entities_short: быстрый выбор получателя (гра... */ integer
   integer declarant_legal_short_id  /* FK на fea_legal_entities_short: быстрый выбор декларанта/брок... */
   integer financial_legal_short_id  /* FK на fea_legal_entities_short: быстрый выбор фин.ответственн... */
   exporter_partner_info_id  /* FK на fea_partners_additional: доп.сведения по экспортеру (гр... */ integer
   consignee_partner_info_id  /* FK на fea_partners_additional: доп.сведения по получателю (гр... */ integer
   integer declarant_partner_info_id  /* FK на fea_partners_additional: доп.сведения по декларанту/бро... */
   integer financial_partner_info_id  /* FK на fea_partners_additional: доп.сведения по фин.ответствен... */
   trade_country_id  /* FK на codes_countries (Графа 11: страна торговли) */ integer
   trade_country_offshore  /* Графа 11: признак офшорной страны (если ведется) */ boolean
   customs_value_total  /* Графа 12: общая таможенная стоимость (сумма по графе 45 позиций) */ numeric(18,2)
   numeric(18,6) usd_uzs_rate  /* Графа 13: курс USD/UZS на дату принятия к оформлению */
   dispatch_country_id  /* FK на codes_countries (Графа 15/15a: страна отправления) */ integer
   destination_country_id  /* FK на codes_countries (Графа 17/17a: страна назначения) */ integer
   transport_main_type_id  /* FK на codes_transport_types (Графа 18: вид транспорта) */ integer
   vehicle_type_code  /* Графа 18: код типа транспортного средства (спец. двузначный) */ varchar(2)
   varchar(32) vehicle_vin  /* Графа 18: VIN/идентификатор ТС */
   vehicle_reg_country_id  /* Графа 18: страна регистрации ТС (FK на codes_countries) */ integer
   carrier_legal_id  /* Графа 18: перевозчик (юр.лицо; FK на fea_legal_entities) */ integer
   carrier_individual_id  /* Графа 18: перевозчик (физ.лицо; FK на fea_individual_entities) */ integer
   text driver_name  /* Графа 18: водитель/ответственное лицо по ТС */
   boolean is_container  /* Графа 19: признак использования контейнера */
   delivery_terms_id  /* FK на codes_delivery_terms (Графа 20: условия поставки) */ integer
   delivery_terms_place  /* Графа 20: пункт по условиям поставки (место) */ text
   payment_form_id  /* FK на codes_payment_forms (Графа 20: код формы оплаты) */ integer
   varchar(10) shipment_form_code  /* Графа 20: код формы отгрузки */
   border_transport_type_id  /* FK на codes_transport_types (Графа 21: транспорт на границе) */ integer
   border_vehicle_reg_country_id  /* Графа 21: страна регистрации ТС на границе (FK на codes_count... */ integer
   contract_currency_id  /* FK на codes_currencies (Графа 22: валюта договора) */ integer
   numeric(18,2) invoice_total  /* Графа 22: общая фактурная стоимость */
   numeric(18,6) contract_currency_rate  /* Графа 23: курс валюты договора к UZS */
   deal_type_id  /* FK на codes_deal_types (Графа 24: характер сделки) */ integer
   settlement_currency_id  /* Графа 24: валюта расчетов (FK на codes_currencies) */ integer
   transport_at_border_id  /* FK на codes_transport_types (Графа 25: вид транспорта на гран... */ integer
   transport_inside_country_id  /* FK на codes_transport_types (Графа 26: вид транспорта внутри ... */ integer
   payer_legal_id  /* FK на fea_legal_entities (Графа 28: плательщик — юр.лицо); ав... */ integer
   payer_individual_id  /* FK на fea_individual_entities (Графа 28: плательщик — физ.лицо) */ integer
   payer_bank_id  /* Графа 28: банк плательщика (FK на banks) */ integer
   payer_bank_account  /* Графа 28: счет плательщика (как введено) */ text
   varchar(20) payer_mfo  /* Графа 28: МФО банка плательщика */
   border_post_id  /* FK на codes_posts (Графа 29: пост на границе) */ integer
   location_license_number  /* Графа 30: номер лицензии склада/СТЗ/магазина (если применимо) */ text
   location_license_date  /* Графа 30: дата лицензии склада/СТЗ/магазина (если применимо) */ date
   text location_address  /* Графа 30: адрес местонахождения товаров */
   location_station_name  /* Графа 30: наименование ЖД станции (если применимо) */ text
   location_district_id  /* FK на codes_districts (Графа 30: район/город местонахождения) */ integer
   procedure_code  /* Графа 37: код процедуры (режим/предыдущий/особенность) */ varchar(7)
   movement_type_id  /* FK на codes_movement_types: особенность перемещения (3-значны... */ integer
   previous_docs_summary  /* Графа 40: краткое резюме/список предшествующих документов (до... */ text
   deferments  /* Графа 48: отсрочки/рассрочки по платежам (JSON) */ jsonb
   warehouse_license_number  /* Графа 49: номер лицензии склада/режима (если применимо) */ text
   warehouse_license_date  /* Графа 49: дата лицензии склада/режима (если применимо) */ date
   text responsible_full_name  /* Графа 50: ответственное лицо — ФИО */
   varchar(14) responsible_pinfl  /* Графа 50: ПИНФЛ ответственного лица */
   text responsible_authority  /* Графа 50: полномочия/основание */
   date obligation_due_date  /* Графа 50: срок обязательства */
   transit_customs_post_id  /* Графа 53: таможенный орган назначения (FK на codes_posts) */ integer
   transit_destination_country_id  /* Графа 53: страна назначения по транзиту (FK на codes_countries) */ integer
   text declaration_place  /* Графа 54: место составления декларации */
   date declaration_date  /* Графа 54: дата составления декларации */
   text contact_full_name  /* Графа 54: ФИО контактного лица */
   text contact_email  /* Графа 54: email контактного лица */
   text contact_phone  /* Графа 54: телефон контактного лица */
   text broker_contract_number  /* Графа 54: номер договора с брокером */
   date broker_contract_date  /* Графа 54: дата договора с брокером */
   declarant_reference  /* Графа 54: номер ГТД декларанта (ПИНФЛ/дата/последовательность) */ text
   external_contract_id  /* “C”: внешний идентификатор контракта (при наличии интеграций) */ text
   regime_dates  /* “C”: даты/сроки по режиму (JSON) */ jsonb
   totals_b  /* “B”: системные итоги по платежам/льготам (только чтение) */ jsonb
   customs_decisions  /* “D”: отметки/решения таможни (только чтение) */ jsonb
   id  /* Служебное поле: первичный ключ (не графа) */ integer
}
class ccd_items {
   timestamp with time zone created_at
   timestamp with time zone updated_at
   timestamp with time zone deleted_at
   text status
   integer document_id
   integer position_no
   text trade_name
   text brand
   text model
   text article
   text grade
   text specification
   text composition
   text energy_class
   date manufacture_date
   boolean is_packed
   integer packages_total
   text package_type
   integer package_count
   varchar(2) bulk_code
   jsonb containers
   jsonb excise_marks
   date supply_period_from
   date supply_period_to
   text aggregated_import_code
   date expiry_date
   varchar(3) investment_project_code
   text tech_equipment_area_code
   integer tech_equipment_year
   text tech_equipment_params
   varchar(2) gov_procurement_code
   text producer_id_code
   integer producer_district_id
   text consumer_id_code
   integer consumer_district_id
   integer additional_unit_id
   numeric(18,6) additional_unit_qty
   integer codes_hs_id
   integer origin_country_id
   varchar(2) origin_alpha2
   numeric(18,6) gross_weight_kg
   numeric(18,6) net_weight_kg
   varchar(7) procedure_code
   numeric(18,6) quota_amount
   integer quota_unit_id
   jsonb previous_docs
   numeric(18,2) invoiced_value
   boolean own_needs_flag
   jsonb documents
   numeric(18,2) customs_value
   numeric(18,3) statistical_value_thousand_usd
   jsonb payments
   integer source_invoice_file_id
   text source_invoice_row_ref
   integer id
}
class node24 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Цифровой код страны (обычно 3 цифры), уникальный */ varchar
   alpha_code  /* Двухбуквенный alpha-2 код страны (ISO 3166-1), уникальный */ varchar
   varchar(255) name  /* Наименование страны */
   offshore  /* Признак офшорной юрисдикции (если ведется список) */ varchar(255)
   integer id  /* Первичный ключ */
}
class node39 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Цифровой код валюты (обычно 3 цифры), уникальный */ varchar
   alpha_code  /* Буквенный alpha-3 код валюты (ISO 4217), уникальный */ varchar
   varchar(255) name  /* Наименование валюты */
   integer id  /* Первичный ключ */
}
class node32 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Цифровой код характера сделки (уникальный) */ varchar
   varchar alpha_code  /* Альтернативный/буквенный код */
   varchar name  /* Наименование характера сделки */
   integer id  /* Первичный ключ */
}
class node26 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Цифровой код по приложению (уникальный) */ varchar
   alpha_code  /* Буквенный код Incoterms (например, EXW, FOB) */ varchar
   varchar name  /* Наименование условия поставки */
   integer id  /* Первичный ключ */
}
class node40 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код района/города (обычно 7 цифр), уникальный */ varchar
   text name  /* Наименование района/города */
   integer id  /* Первичный ключ */
}
class node15 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код формы (уникальный) */ varchar
   text name  /* Наименование формы */
   npa  /* Нормативно-правовой акт (реквизиты) */ text
   npa_url  /* Ссылка на НПА (URL) */ text
   integer id  /* Первичный ключ */
}
class node1 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код ТН ВЭД (обычно 10 цифр), уникальный */ varchar
   text description  /* Описание товарной позиции */
   integer id  /* Первичный ключ */
}
class node0 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код особенности/процедуры (уникальный) */ varchar
   text name  /* Наименование особенности/процедуры */
   integer id  /* Первичный ключ */
}
class node22 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код формы оплаты (уникальный) */ varchar
   varchar name  /* Наименование формы оплаты */
   integer id  /* Первичный ключ */
}
class node16 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код поста (обычно 5 цифр), уникальный */ varchar
   text name  /* Наименование таможенного поста */
   varchar(255) phone_number  /* Контактный телефон поста */
   location_url  /* Ссылка на местоположение (карта/координаты) */ text
   integer id  /* Первичный ключ */
}
class node41 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Код вида транспорта (уникальный) */ varchar
   varchar name  /* Наименование вида транспорта */
   short_name  /* Краткое обозначение (аббревиатура) */ varchar
   integer id  /* Первичный ключ */
}
class node11 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (мягкое удаление) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Цифровой код единицы измерения (уникальный) */ varchar
   alpha_code  /* Буквенный код/сокращение единицы (например, L, M3) */ varchar
   varchar name  /* Наименование единицы измерения */
   integer id  /* Первичный ключ */
}
class currency_exchange_rate {
   timestamp with time zone created_at
   timestamp with time zone updated_at
   timestamp with time zone deleted_at
   varchar(255) status
   integer codes_currency_id
   numeric rate
   integer id
}
class node35 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   region_id  /* FK на codes_districts (место жительства/район) */ integer
   pinfl  /* ПИНФЛ физического лица (используется в графах 2/8/9/14 и 50) */ varchar
   text full_name  /* ФИО */
   text address  /* Адрес проживания */
   district_id  /* FK на codes_districts (район) */ integer
   varchar phone  /* Контактный телефон */
   varchar passport_number  /* Серия/номер паспорта */
   date passport_issued_at  /* Дата выдачи паспорта */
   text passport_issued_by  /* Кем выдан паспорт */
   patent_number  /* Номер патента (при наличии) */ text
   text extra_info  /* Дополнительные сведения */
   current_account_number  /* Расчетный счет (для графы 28 при участии физ.лица) */ text
   current_account_bank_id  /* FK на banks (банк расчетного счета) */ integer
   text fx_account_number  /* Валютный счет */
   fx_account_bank_id  /* FK на banks (банк валютного счета) */ integer
   integer id  /* Первичный ключ */
}
class node34 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   region_id  /* FK на codes_districts (юридический адрес/район), используется... */ integer
   varchar(255) okpo  /* ОКПО организации */
   inn  /* ИНН организации (ключевой реквизит для граф 2/8/9/14) */ varchar(255)
   varchar(255) name  /* Полное наименование организации */
   varchar(255) address  /* Юридический/почтовый адрес */
   varchar(255) additional_information  /* Доп. сведения */
   varchar(255) supervisor  /* Руководитель/контактное лицо */
   oked  /* ОКЭД (числовое значение) */ integer
   oked_code  /* ОКЭД (код) */ integer
   varchar(255) phone_number  /* Контактный телефон */
   varchar(255) registration_number  /* Номер регистрации */
   varchar(255) registration_date  /* Дата регистрации */
   current_account_number  /* Расчетный счет (используется при заполнении графы 28) */ varchar(255)
   current_account_bank_id  /* FK на banks (банк расчетного счета) */ integer
   fx_account_number  /* Валютный счет (при наличии) */ varchar(255)
   fx_account_bank_id  /* FK на banks (банк валютного счета) */ integer
   integer id  /* Первичный ключ */
}
class node7 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   varchar(255) okpo  /* ОКПО организации */
   inn  /* ИНН организации (используется в графах 2/8/9/14) */ varchar(255)
   varchar(255) name  /* Наименование организации */
   varchar(255) address  /* Адрес организации */
   integer id  /* Первичный ключ */
}
class node8 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   codes_country_id  /* FK на codes_countries; страна контрагента (используется в гра... */ integer
   address  /* Почтовый адрес контрагента (используется в графах 2/8/9/14) */ text
   integer id  /* Первичный ключ */
}
class node38 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   name  /* Наименование контрагента (для печатных форм и подсказок в гра... */ varchar(255)
   varchar(255) address  /* Адрес контрагента */
   country_id  /* FK на codes_countries (страна контрагента) */ integer
   additional_info  /* Прочая информация (телефоны, примечания) */ text
   integer id  /* Первичный ключ */
}
class node2 {
   timestamp with time zone created_at  /* Дата/время загрузки файла */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   text status  /* Статус файла: active | deleted | archived */
   text storage  /* Тип хранилища: s3 | minio | local */
   text bucket  /* Имя бакета */
   text object_key  /* Ключ объекта в бакете */
   text original_name  /* Оригинальное имя файла */
   text mime_type  /* MIME-тип файла */
   extension  /* Расширение (если известно) */ text
   bigint size_bytes  /* Размер файла в байтах */
   text etag  /* ETag/хеш объекта для проверки целостности */
   content_disposition  /* Режим отдачи (inline/attachment; filename=...) */ text
   jsonb metadata  /* Произвольные метаданные провайдера */
   uploaded_by  /* FK на users (кто загрузил) */ integer
   organization_id  /* FK на organizations (чья сущность файла) */ integer
   integer id  /* Первичный ключ */
}
class node13 {
   timestamp with time zone created_at  /* Когда создан ключ */
   text response_hash  /* Хеш ответа для сравнения */
   text key  /* Уникальный ключ идемпотентности */
}
class node10 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   user_id  /* Уникальная связь с users (1:1) */ integer
   date birthday  /* Дата рождения */
   varchar citizenship  /* Гражданство */
   varchar address  /* Адрес проживания */
   pinfl  /* ПИНФЛ (графы 2/8/14/50/54) */ varchar
   varchar document_serial_number  /* Серия/номер документа */
   date document_issued_date  /* Дата выдачи документа */
   varchar document_issued_by  /* Кем выдан документ */
   integer id  /* Первичный ключ */
}
class node12 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   user_id  /* Уникальная связь с users (1:1) */ integer
   inn  /* ИНН юр.лица (графы 14/54) */ varchar
   varchar oked  /* ОКЭД */
   varchar address  /* Юридический адрес */
   varchar vat_status  /* Статус плательщика НДС */
   varchar vat_registration_number  /* Регистрационный номер НДС */
   date vat_registration_date  /* Дата регистрации НДС */
   bank_mfo  /* МФО обслуживающего банка (для графы 28) */ varchar
   bank_current_account  /* Расчетный счет (для графы 28) */ varchar
   customs_broker_registration_number  /* Рег. номер таможенного брокера (для графы 14 при брокере) */ varchar
   date customs_broker_registration_date  /* Дата регистрации брокера */
   integer id  /* Первичный ключ */
}
class node28 {
   timestamp with time zone created_at
   timestamp with time zone updated_at
   timestamp with time zone deleted_at
   text status
   integer organization_id  /* FK на organizations: лимит на уровне организации */
   integer user_id  /* FK на users: лимит на уровне пользователя */
   integer document_id  /* FK на ccd_documents: опционально связывает OCR с конкретной д... */
   input_file_id  /* Входной файл (скан/фото первичного документа) */ integer
   text job_type  /* Тип задания: invoice | contract | cmr | other */
   text model  /* Модель провайдера */
   text mode  /* Режим: ocr/vision/layout и т.п. */
   text language_hint  /* Подсказка языка для OCR */
   integer page_count
   tokens_prompt  /* Затраты токенов на вход (prompt/context) */ bigint
   tokens_output  /* Затраты токенов на выход (completion/вывод) */ bigint
   bigint tokens_total  /* Итого токенов за задание */
   output_data  /* Результат OCR в JSON (распознанные поля для автозаполнения CCD) */ jsonb
   jsonb meta
   integer id
}
class node20 {
   timestamp with time zone created_at
   timestamp with time zone updated_at
   timestamp with time zone deleted_at
   text status
   integer organization_id  /* FK на organizations: лимит на организацию */
   integer user_id  /* FK на users: лимит на пользователя */
   period_month  /* Месяц лимита (первый день месяца) */ date
   integer price_plan_id  /* FK на price_plans: тариф, по которому установлен лимит */
   bigint limit_tokens  /* Месячный лимит токенов */
   bigint used_tokens  /* Использовано токенов за месяц */
   bigint carryover_from_prev_month  /* Перенос остатка токенов с прошлого месяца */
   overage_allowed  /* Разрешен ли перерасход (с последующим биллингом) */ boolean
   timestamp with time zone blocked_at  /* Момент блокировки при превышении лимита */
   jsonb meta
   integer id
}
class node17 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   varchar name  /* Наименование организации в системе */
   varchar domain  /* Домен/namespace организации */
   boolean verified  /* Признак верификации организации */
   integer id  /* Первичный ключ */
}
class node18 {
   integer invoice_id  /* FK на payment_invoices */
   text name  /* Наименование позиции */
   numeric(18,4) quantity  /* Количество */
   bigint unit_price  /* Цена за единицу в минорных единицах */
   meta  /* Служебные поля (JSON) */ jsonb
   integer id  /* Первичный ключ */
}
class node33 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   organization_id  /* FK на organizations (счет на юр.лицо) */ integer
   user_id  /* FK на users (счет на физ.лицо) */ integer
   text title  /* Заголовок счета */
   text description  /* Описание счета */
   bigint amount_total  /* Итоговая сумма в минорных единицах */
   currency  /* Буквенный код валюты (например, UZS, USD) */ text
   timestamp with time zone due_at  /* Срок оплаты */
   meta  /* Служебные поля/JSON (может содержать ссылку на CCD) */ jsonb
   integer id  /* Первичный ключ */
}
class node29 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   code  /* Системный код провайдера (уникальный) */ varchar
   text display_name  /* Отображаемое имя провайдера */
   integer id  /* Первичный ключ */
}
class node14 {
   integer provider_id  /* FK на payment_providers */
   invoice_id  /* FK на payment_invoices (может быть NULL при предсоздании) */ integer
   user_id  /* FK на users (инициатор платежа-физлицо) */ integer
   organization_id  /* FK на organizations (инициатор-предприятие) */ integer
   bigint amount  /* Сумма в минорных единицах */
   text currency  /* Код валюты */
   text client_reference  /* Внешний client/order ID */
   text return_url  /* URL возврата после оплаты */
   text status  /* Статус: created | processing | succeeded | failed | canceled */
   meta  /* Служебные поля провайдера/клиента (JSON) */ jsonb
   timestamp with time zone created_at  /* Дата/время создания */
   timestamp with time zone updated_at  /* Дата/время обновления */
   integer id  /* Первичный ключ */
}
class node23 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   price_plan_id  /* FK на price_plans (если транзакция по тарифу) */ integer
   integer organization_id  /* FK на organizations */
   integer user_id  /* FK на users */
   integer provider_id  /* FK на payment_providers */
   integer session_id  /* FK на payment_sessions */
   integer invoice_id  /* FK на payment_invoices */
   bigint amount  /* Сумма в минорных единицах */
   text currency  /* Код валюты */
   text external_id  /* Идентификатор транзакции у провайдера */
   method  /* Метод оплаты (PAYME|CLICK|OTHER) */ text
   meta  /* Служебные поля/сырые payload (без ПД) */ jsonb
   integer id  /* Первичный ключ */
}
class node5 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   varchar type  /* Тип тарифа: individual | enterprise-per-user | enterprise */
   bigint tokens  /* Лимит токенов/квота использования */
   integer price  /* Цена в минорных единицах указанной валюты */
   codes_currency_id  /* FK на codes_currencies (валюта тарифа) */ integer
   integer id  /* Первичный ключ */
}
class node21 {
   integer transaction_id  /* FK на payment_transactions */
   integer provider_id  /* FK на payment_providers */
   amount  /* Сумма возврата (минорные единицы) */ bigint
   text status  /* Статус: pending | succeeded | failed | canceled */
   text provider_refund_id  /* ID возврата у провайдера */
   meta  /* Служебные поля (JSON) */ jsonb
   timestamp with time zone created_at  /* Дата/время создания записи */
   integer id  /* Первичный ключ */
}
class node4 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   varchar name  /* Имя роли */
   integer id  /* Первичный ключ */
}
class node36 {
   timestamp with time zone created_at  /* Дата/время создания записи */
   timestamp with time zone updated_at  /* Дата/время изменения записи */
   deleted_at  /* Дата/время удаления (soft delete) */ timestamp with time zone
   varchar(255) status  /* Статус записи: active | deleted | archived */
   role_id  /* FK на roles (роль пользователя) */ integer
   organization_id  /* FK на organizations (принадлежность пользователя) */ integer
   varchar first_name  /* Имя */
   varchar last_name  /* Фамилия */
   varchar middle_name  /* Отчество */
   varchar email  /* Электронная почта */
   varchar phone_number  /* Номер телефона */
   boolean agreement  /* Согласие с условиями/офертой */
   integer id  /* Первичный ключ */
}
class node31 {
   integer provider_id  /* FK на payment_providers */
   text event_type  /* Тип события */
   boolean signature_ok  /* Проверка подписи вебхука пройдена */
   jsonb payload  /* Сырой JSON от провайдера */
   timestamp with time zone received_at  /* Время получения */
   timestamp with time zone processed_at  /* Время обработки */
   bigint id  /* Первичный ключ */
}

node25  -->  node1 : codes_hs_id -> id
node25  -->  node11 : codes_units_id -> id
node6  -->  node17 : organization_id -> id
node6  -->  node36 : user_id -> id
node3  -->  node17 : organization_id -> id
node3  -->  node36 : user_id -> id
node37  -->  node17 : organization_id -> id
node37  -->  node36 : user_id -> id
node42  -->  node17 : organization_id -> id
node42  -->  node36 : user_id -> id
node19  -->  node30 : payer_bank_id -> id
node19  -->  node24 : trade_country_id -> id
node19  -->  node24 : vehicle_reg_country_id -> id
node19  -->  node24 : transit_destination_country_id -> id
node19  -->  node24 : dispatch_country_id -> id
node19  -->  node24 : destination_country_id -> id
node19  -->  node24 : border_vehicle_reg_country_id -> id
node19  -->  node39 : contract_currency_id -> id
node19  -->  node39 : settlement_currency_id -> id
node19  -->  node32 : deal_type_id -> id
node19  -->  node26 : delivery_terms_id -> id
node19  -->  node40 : location_district_id -> id
node19  -->  node15 : form_id -> id
node19  -->  node0 : movement_type_id -> id
node19  -->  node22 : payment_form_id -> id
node19  -->  node16 : post_id -> id
node19  -->  node16 : transit_customs_post_id -> id
node19  -->  node16 : border_post_id -> id
node19  -->  node41 : transport_main_type_id -> id
node19  -->  node41 : transport_inside_country_id -> id
node19  -->  node41 : border_transport_type_id -> id
node19  -->  node41 : transport_at_border_id -> id
node19  -->  node35 : financial_individual_id -> id
node19  -->  node35 : carrier_individual_id -> id
node19  -->  node35 : exporter_individual_id -> id
node19  -->  node35 : payer_individual_id -> id
node19  -->  node35 : declarant_individual_id -> id
node19  -->  node35 : consignee_individual_id -> id
node19  -->  node34 : financial_legal_id -> id
node19  -->  node34 : exporter_legal_id -> id
node19  -->  node34 : payer_legal_id -> id
node19  -->  node34 : declarant_legal_id -> id
node19  -->  node34 : carrier_legal_id -> id
node19  -->  node34 : consignee_legal_id -> id
node19  -->  node7 : financial_legal_short_id -> id
node19  -->  node7 : exporter_legal_short_id -> id
node19  -->  node7 : declarant_legal_short_id -> id
node19  -->  node7 : consignee_legal_short_id -> id
node19  -->  node38 : consignee_partner_info_id -> id
node19  -->  node38 : financial_partner_info_id -> id
node19  -->  node38 : exporter_partner_info_id -> id
node19  -->  node38 : declarant_partner_info_id -> id
node19  -->  node17 : organization_id -> id
node19  -->  node36 : created_by_user_id -> id
ccd_items  -->  node19 : document_id -> id
ccd_items  -->  node24 : origin_country_id -> id
ccd_items  -->  node40 : consumer_district_id -> id
ccd_items  -->  node40 : producer_district_id -> id
ccd_items  -->  node1 : codes_hs_id -> id
ccd_items  -->  node11 : additional_unit_id -> id
ccd_items  -->  node11 : quota_unit_id -> id
ccd_items  -->  node2 : source_invoice_file_id -> id
currency_exchange_rate  -->  node39 : codes_currency_id -> id
node8  -->  node24 : codes_country_id -> id
node2  -->  node17 : organization_id -> id
node2  -->  node36 : uploaded_by -> id
node10  -->  node36 : user_id -> id
node12  -->  node36 : user_id -> id
node28  -->  node19 : document_id -> id
node28  -->  node2 : input_file_id -> id
node28  -->  node17 : organization_id -> id
node28  -->  node36 : user_id -> id
node20  -->  node17 : organization_id -> id
node20  -->  node5 : price_plan_id -> id
node20  -->  node36 : user_id -> id
node18  -->  node33 : invoice_id -> id
node33  -->  node17 : organization_id -> id
node33  -->  node36 : user_id -> id
node14  -->  node17 : organization_id -> id
node14  -->  node33 : invoice_id -> id
node14  -->  node29 : provider_id -> id
node14  -->  node36 : user_id -> id
node23  -->  node17 : organization_id -> id
node23  -->  node33 : invoice_id -> id
node23  -->  node29 : provider_id -> id
node23  -->  node14 : session_id -> id
node23  -->  node5 : price_plan_id -> id
node23  -->  node36 : user_id -> id
node5  -->  node39 : codes_currency_id -> id
node21  -->  node29 : provider_id -> id
node21  -->  node23 : transaction_id -> id
node36  -->  node17 : organization_id -> id
node36  -->  node4 : role_id -> id
node31  -->  node29 : provider_id -> id
